<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Strings – MA500: Introduction to R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./07_EDA.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-0de45b8b5f35a93596f1d788d60c4c11.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-94859c87fd2e0f79297c4bdcf1025212.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./08_Strings.html">Strings</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">MA500: Introduction to R</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MA-500: Introduction to R</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_install.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R/RStudio Installation Guide</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_Basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R Basics &amp; Fundamentals</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_CLF.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Conditionals, Loops, and Functions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_Dataframes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Dataframes</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_Visualizations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Visualizations</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_EDA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exploratory Data Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_Strings.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Strings</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#subsetting-strings" id="toc-subsetting-strings" class="nav-link active" data-scroll-target="#subsetting-strings">Subsetting strings</a>
  <ul class="collapse">
  <li><a href="#using-str_sub" id="toc-using-str_sub" class="nav-link" data-scroll-target="#using-str_sub">Using <code>str_sub()</code></a></li>
  </ul></li>
  <li><a href="#detecting-string-matches" id="toc-detecting-string-matches" class="nav-link" data-scroll-target="#detecting-string-matches">Detecting string matches</a>
  <ul class="collapse">
  <li><a href="#using-str_detect" id="toc-using-str_detect" class="nav-link" data-scroll-target="#using-str_detect">Using <code>str_detect()</code></a></li>
  </ul></li>
  <li><a href="#regex-basics-or-regular-expressions" id="toc-regex-basics-or-regular-expressions" class="nav-link" data-scroll-target="#regex-basics-or-regular-expressions">Regex Basics or Regular Expressions</a></li>
  <li><a href="#mutating-string-variables" id="toc-mutating-string-variables" class="nav-link" data-scroll-target="#mutating-string-variables">Mutating string variables</a>
  <ul class="collapse">
  <li><a href="#using-str_replace" id="toc-using-str_replace" class="nav-link" data-scroll-target="#using-str_replace">Using <code>str_replace()</code></a></li>
  <li><a href="#looking-for-multiple-patterns-at-once" id="toc-looking-for-multiple-patterns-at-once" class="nav-link" data-scroll-target="#looking-for-multiple-patterns-at-once">Looking for multiple patterns at once</a></li>
  <li><a href="#re-coding-based-off-a-variable-in-a-data-set" id="toc-re-coding-based-off-a-variable-in-a-data-set" class="nav-link" data-scroll-target="#re-coding-based-off-a-variable-in-a-data-set">Re-coding based off a variable in a data set</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Strings</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Often times, we come across messy or inconsistent data. This can be due to a number of potential reasons, but more often than not, it is due to lack of data validations, user-entry errors, etc. In order to formally analyze the data. it is imperative that the data be cleaned or put into a standard form.</p>
<p>To manipulate, clean, or analyze string variables, we will be using the <code>stringr</code> library (which is part of the <code>tidyverse</code> universe!).</p>
<div class="cell">
<details open="" class="code-fold">
<summary>hide code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.4.4     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
</div>
<section id="subsetting-strings" class="level2">
<h2 class="anchored" data-anchor-id="subsetting-strings">Subsetting strings</h2>
<p>We can subset (grab portions of string variables) strings by using the <code>str_sub</code> function.</p>
<section id="using-str_sub" class="level3">
<h3 class="anchored" data-anchor-id="using-str_sub">Using <code>str_sub()</code></h3>
<div class="callout-example-white">
<div class="cell">
<details open="" class="code-fold">
<summary>hide code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"stats"</span>, <span class="st">"statistics"</span>, <span class="st">"math"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str_sub</span>(x, <span class="dv">1</span>, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "stat" "stat" "math"</code></pre>
</div>
</div>
<ul>
<li><code>1</code> means start at the first position</li>
<li><code>4</code> means end at the fourth position</li>
</ul>
<p>We can also grab backwards</p>
<div class="cell">
<details open="" class="code-fold">
<summary>hide code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_sub</span>(x, <span class="sc">-</span><span class="dv">3</span>, <span class="sc">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ats" "ics" "ath"</code></pre>
</div>
</div>
<ul>
<li><p><code>-3</code> means the 3rd to the last position</p></li>
<li><p><code>-1</code> means the last position</p></li>
</ul>
<p>Using <code>str_sub()</code> is useful when we need to split up strings! For example, let’s say we have different flight codes: <code>UA1234", "DL845", "AA99"</code> where the first two letters correspond to an airline and the numbers indicate the flight number. We can use the function to split it up and create new variables to store it.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>hide code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">flight =</span> <span class="fu">c</span>(<span class="st">"UA1234"</span>, <span class="st">"DL845"</span>, <span class="st">"AA99"</span>))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">airline =</span> <span class="fu">str_sub</span>(flight, <span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">flight_num =</span> <span class="fu">str_sub</span>(flight, <span class="dv">3</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  flight airline flight_num
1 UA1234      UA       1234
2  DL845      DL        845
3   AA99      AA         99</code></pre>
</div>
</div>
</div>
</section>
</section>
<section id="detecting-string-matches" class="level2">
<h2 class="anchored" data-anchor-id="detecting-string-matches">Detecting string matches</h2>
<p>Often times, we may want to iterate through different string variables by a specific pattern we recognize. We can do so by using the <code>str_detect()</code> function.</p>
<section id="using-str_detect" class="level3">
<h3 class="anchored" data-anchor-id="using-str_detect">Using <code>str_detect()</code></h3>
<div class="callout-example-white">
<div class="cell">
<details open="" class="code-fold">
<summary>hide code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"stats"</span>, <span class="st">"statistics"</span>, <span class="st">"math"</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str_detect</span>(x, <span class="st">"stat"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE  TRUE FALSE</code></pre>
</div>
</div>
<p>The output returns a BOOLEAN variable that indicates if the variable at that position detects the given pattern. We can see that it returns <code>TRUE</code> for the first two elements and <code>FALSE</code> for the last.</p>
<p>We can also specify if we want to find numbers or digits in the string.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>hide code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>class <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"MA500"</span>, <span class="st">"MA541"</span>,<span class="st">"MATH"</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># detect if numbers exist in string</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str_detect</span>(class, <span class="st">"[0-9]+"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE  TRUE FALSE</code></pre>
</div>
</div>
<p>This also returns <code>TRUE</code> for the first two elements and <code>FALSE</code> for the last, since the string <code>MATH</code> does not contain any digits.</p>
<p>Since the output of <code>str_detect</code> is boolean, it is useful to use the function when we are filtering through data.</p>
<div class="cell" data-echo.="true">
<details open="" class="code-fold">
<summary>hide code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(flight, <span class="st">"UA"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  flight airline flight_num
1 UA1234      UA       1234</code></pre>
</div>
</div>
</div>
</section>
</section>
<section id="regex-basics-or-regular-expressions" class="level2">
<h2 class="anchored" data-anchor-id="regex-basics-or-regular-expressions">Regex Basics or Regular Expressions</h2>
<p><strong>What is Regex?</strong></p>
<ul>
<li>It is a concise language for describing patterns in strings</li>
</ul>
<p>Regex is most helpful for generalizing variations of text you see into one pattern. For instance, different spellings, abbreviations, typos, or characters can be captured into a regex rule, BUT the syntax can be a bit complex.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Some basic Regex syntax
</div>
</div>
<div class="callout-body-container callout-body">
<table class="caption-top table">
<thead>
<tr class="header">
<th>Pattern</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>[0-9]</code> or <code>\\d</code></td>
<td>any digit from 0 - 9</td>
</tr>
<tr class="even">
<td><code>[A-Z]</code></td>
<td>any UPPERCASE letter from A - Z</td>
</tr>
<tr class="odd">
<td><code>[a-z]</code></td>
<td>any LOWERCASE letter from A - Z</td>
</tr>
<tr class="even">
<td><code>+</code></td>
<td>one or more <em>(usually used in combination of above patterns)</em></td>
</tr>
<tr class="odd">
<td><code>?</code></td>
<td>zero or one</td>
</tr>
<tr class="even">
<td><code>*</code></td>
<td>zero or more</td>
</tr>
<tr class="odd">
<td><code>^</code></td>
<td>start of string</td>
</tr>
<tr class="even">
<td><code>$</code></td>
<td>end of string</td>
</tr>
<tr class="odd">
<td><code>.</code></td>
<td>every character except a new line</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>In our example above, to detect if the string variable contained digits we utilized <code>[0-9]</code> and a <code>+</code> at the end, meaning any digit and it can occur one or more times.</p>
<div class="callout-example-white">
<p>Some regex patterns:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>hide code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(flight, <span class="st">"^UA"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  flight airline flight_num
1 UA1234      UA       1234</code></pre>
</div>
</div>
<p>The above code detects strings that START with <code>UA</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>hide code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>hobbies <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"cooking"</span>, <span class="st">"reading"</span>, <span class="st">"eating"</span>, <span class="st">"dance"</span>, <span class="st">"sport"</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str_detect</span>(hobbies, <span class="st">"ing$"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE  TRUE  TRUE FALSE FALSE</code></pre>
</div>
</div>
<p>This code detects strings that END with <code>ing</code>. (these two functionalities can also be done with the functions: <code>str_starts()</code> and <code>str_ends()</code>)</p>
<div class="cell">
<details open="" class="code-fold">
<summary>hide code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>hobbies <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"cooking"</span>, <span class="st">"reading"</span>, <span class="st">"eating"</span>, <span class="st">"dance"</span>, <span class="st">"sport"</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str_starts</span>(hobbies, <span class="st">"cook"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE FALSE FALSE FALSE FALSE</code></pre>
</div>
<details open="" class="code-fold">
<summary>hide code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_ends</span>(hobbies, <span class="st">"ing"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE  TRUE  TRUE FALSE FALSE</code></pre>
</div>
</div>
</div>
</section>
<section id="mutating-string-variables" class="level2">
<h2 class="anchored" data-anchor-id="mutating-string-variables">Mutating string variables</h2>
<p>The <code>str_sub()</code> function can be used to directly change the values we find/subset.</p>
<div class="callout-example-white">
<p>In our <code>hobbies</code> vector, let’s remove any <code>ing</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>hide code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>hobbies <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"cooking"</span>, <span class="st">"reading"</span>, <span class="st">"eating"</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str_sub</span>(hobbies, <span class="sc">-</span><span class="dv">3</span>, <span class="sc">-</span><span class="dv">1</span>) <span class="ot">&lt;-</span> <span class="st">""</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(hobbies)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "cook" "read" "eat" </code></pre>
</div>
</div>
<ul>
<li><code>str_sub(hobbies, -3,-1) &lt;- ""</code> indicates that we want to replace the characters at the 3rd to the last position TO the last position with a blank.</li>
</ul>
<p>But, a more efficient way would be to remove <code>ing</code> by using the <code>str_replace()</code> function. This will allow us to avoid directly utilizing the positions of the pattern of interest.</p>
</div>
<section id="using-str_replace" class="level3">
<h3 class="anchored" data-anchor-id="using-str_replace">Using <code>str_replace()</code></h3>
<div class="callout-example-white">
<div class="cell">
<details open="" class="code-fold">
<summary>hide code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>hobbies <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"cooking"</span>, <span class="st">"reading"</span>, <span class="st">"eating"</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str_replace</span>(hobbies, <span class="st">"ing"</span>, <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "cook" "read" "eat" </code></pre>
</div>
<details open="" class="code-fold">
<summary>hide code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(hobbies)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "cooking" "reading" "eating" </code></pre>
</div>
<details open="" class="code-fold">
<summary>hide code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>hobbies <span class="ot">&lt;-</span> <span class="fu">str_replace</span>(hobbies, <span class="st">"ing"</span>, <span class="st">""</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(hobbies)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "cook" "read" "eat" </code></pre>
</div>
</div>
<ul>
<li><code>str_replace(hobbies, "ing", "")</code> indicates we want to replace <code>ing</code> with a blank</li>
</ul>
<p>Note: <code>str_replace</code> only replaces the <strong>first</strong> instance or the <strong>first matched pattern</strong> in each string. If you are interested in replacing <em>all</em> instances, use <code>str_replace_all</code></p>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you notice from the examples above, <code>str_sub</code> directly affects the original vector, while <code>str_replace</code> does not change the original vector, but rather returns a modified copy. In order to retain these changes, we had to directly overwrite the hobbies vector.</p>
</div>
</div>
</section>
<section id="looking-for-multiple-patterns-at-once" class="level3">
<h3 class="anchored" data-anchor-id="looking-for-multiple-patterns-at-once">Looking for multiple patterns at once</h3>
<p>Don’t forget that logical operators exist! For example, if we want to subset only Math and Business classes (MA or BA):</p>
<div class="cell">
<details open="" class="code-fold">
<summary>hide code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"MA500"</span>, <span class="st">"BA124"</span>, <span class="st">"MA354"</span>, <span class="st">"PY100"</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str_detect</span>(x, <span class="st">"MA|BA"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE  TRUE  TRUE FALSE</code></pre>
</div>
</div>
<p>But, for a more complex example:</p>
<div class="callout-example-white">
<p>Let’s detect string variables that match all possible iterations of Males.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>hide code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>gender <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"math"</span>, <span class="st">"MALE"</span>, <span class="st">"m"</span>, <span class="st">"female"</span>, <span class="st">"Male"</span>, <span class="st">"Female"</span>, <span class="st">"Male1"</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str_detect</span>(gender, <span class="st">"m"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE FALSE  TRUE  TRUE FALSE  TRUE FALSE</code></pre>
</div>
</div>
<p>Notice, the second element returns <code>FALSE</code> but we expect it to be true. That is because our string detection is <strong>case-sensitive.</strong> Good practice is to first bring everything to lower case using the function <code>str_to_lower</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>hide code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>gender <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"math"</span>, <span class="st">"MALE"</span>, <span class="st">"m"</span>, <span class="st">"female"</span>, <span class="st">"Male"</span>, <span class="st">"Female"</span>, <span class="st">"Male1"</span>) </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str_detect</span>(gender, <span class="st">"m"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE FALSE  TRUE  TRUE FALSE  TRUE FALSE</code></pre>
</div>
</div>
<p>Now, we see everything returns <code>TRUE</code> , but we expect the Female strings to be <code>FALSE</code>. That is because providing <code>str_detect</code> with only <code>m</code> will just check if the variable contains <code>m</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>hide code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>gender <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"math"</span>, <span class="st">"MALE"</span>, <span class="st">"m"</span>, <span class="st">"female"</span>, <span class="st">"Male"</span>, <span class="st">"Female"</span>, <span class="st">"Male1"</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str_detect</span>(<span class="fu">str_to_lower</span>(gender), <span class="st">"^m"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE  TRUE  TRUE FALSE  TRUE FALSE  TRUE</code></pre>
</div>
</div>
<p>We added in <code>^</code> to indicate the string should start with <code>m</code>, but it also returns <code>TRUE</code> for the first element. Let’s fix this up one more time.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>hide code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>gender <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"math"</span>, <span class="st">"MALE"</span>, <span class="st">"m"</span>, <span class="st">"female"</span>, <span class="st">"Male"</span>, <span class="st">"Female"</span>, <span class="st">"Male1"</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str_detect</span>(<span class="fu">str_to_lower</span>(gender), <span class="st">"^(m)$|^(male)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE  TRUE  TRUE FALSE  TRUE FALSE  TRUE</code></pre>
</div>
</div>
<ul>
<li><p><code>^(m)$</code>: means start with m and ends with m -&gt; so quite literally just <code>m</code></p></li>
<li><p><code>^(male)</code>: means starts with <code>male</code></p></li>
</ul>
</div>
</section>
<section id="re-coding-based-off-a-variable-in-a-data-set" class="level3">
<h3 class="anchored" data-anchor-id="re-coding-based-off-a-variable-in-a-data-set">Re-coding based off a variable in a data set</h3>
<p>For this example, we want to clean this gender vector: <code>gender = c( "M", "male", "FEMALE", "f", "Fem", "maLe", "Feemale", "fem.", "MALE", "m.", "femail", "Unknown", "?", "u", "U.", "N/A", "none", "", "Other","prefer_not", "MALE", "femAle", "Prefers not", "Othr", "na"</code> by standardizing its values — replacing each messy or inconsistent entry with a consistent label (e.g., ‘Male’ or ‘Female’). For this, we will use <code>case_when()</code> which is like an <code>ifelse</code> statement but easier to implement with many cases.</p>
<p>The syntax for <code>case_when</code>: <code>condition ~ value</code>.</p>
<div class="callout-example-white">
<ol type="1">
<li>Create a new data frame with a column gender</li>
</ol>
<div class="cell">
<details open="" class="code-fold">
<summary>hide code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>gen_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">gender =</span> <span class="fu">c</span>(</span>
<span id="cb41-2"><a href="#cb41-2"></a>  <span class="st">"M"</span>, <span class="st">"male"</span>, <span class="st">"FEMALE"</span>, <span class="st">"f"</span>, <span class="st">"Fem"</span>, <span class="st">"maLe"</span>, </span>
<span id="cb41-3"><a href="#cb41-3"></a>  <span class="st">"Feemale"</span>, <span class="st">"fem."</span>, <span class="st">"MALE"</span>, <span class="st">"m."</span>, <span class="st">"femail"</span>, </span>
<span id="cb41-4"><a href="#cb41-4"></a>  <span class="st">"Unknown"</span>, <span class="st">"?"</span>, <span class="st">"u"</span>, <span class="st">"U."</span>, <span class="st">"N/A"</span>, <span class="st">"none"</span>, <span class="st">""</span>, </span>
<span id="cb41-5"><a href="#cb41-5"></a>  <span class="st">"Other"</span>,<span class="st">"prefer_not"</span>, </span>
<span id="cb41-6"><a href="#cb41-6"></a>  <span class="st">"MALE"</span>, <span class="st">"femAle"</span>, <span class="st">"Prefers not"</span>, <span class="st">"Othr"</span>, <span class="st">"na"</span></span>
<span id="cb41-7"><a href="#cb41-7"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ol start="2" type="1">
<li>Set up a <code>mutate</code> call to create a new column <code>gender_clean</code> to store our categorized values in.</li>
</ol>
<div class="cell">
<details open="" class="code-fold">
<summary>hide code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>gen_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">gender =</span> <span class="fu">c</span>(</span>
<span id="cb42-2"><a href="#cb42-2"></a>  <span class="st">"M"</span>, <span class="st">"male"</span>, <span class="st">"FEMALE"</span>, <span class="st">"f"</span>, <span class="st">"Fem"</span>, <span class="st">"maLe"</span>, </span>
<span id="cb42-3"><a href="#cb42-3"></a>  <span class="st">"Feemale"</span>, <span class="st">"fem."</span>, <span class="st">"MALE"</span>, <span class="st">"m."</span>, <span class="st">"femail"</span>, </span>
<span id="cb42-4"><a href="#cb42-4"></a>  <span class="st">"Unknown"</span>, <span class="st">"?"</span>, <span class="st">"u"</span>, <span class="st">"U."</span>, <span class="st">"N/A"</span>, <span class="st">"none"</span>, <span class="st">""</span>, </span>
<span id="cb42-5"><a href="#cb42-5"></a>  <span class="st">"Other"</span>,<span class="st">"prefer_not"</span>, </span>
<span id="cb42-6"><a href="#cb42-6"></a>  <span class="st">"MALE"</span>, <span class="st">"femAle"</span>, <span class="st">"Prefers not"</span>, <span class="st">"Othr"</span>, <span class="st">"na"</span></span>
<span id="cb42-7"><a href="#cb42-7"></a>))</span>
<span id="cb42-8"><a href="#cb42-8"></a></span>
<span id="cb42-9"><a href="#cb42-9"></a>gen_df <span class="ot">&lt;-</span> gen_df <span class="sc">%&gt;%</span> </span>
<span id="cb42-10"><a href="#cb42-10"></a>  <span class="fu">mutate</span>(<span class="at">gender_clean =</span> <span class="fu">case_when</span>(</span>
<span id="cb42-11"><a href="#cb42-11"></a>    </span>
<span id="cb42-12"><a href="#cb42-12"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ol start="3" type="1">
<li>Work on categorizing all potential male values (M, male, MaLe, MALE, m, MALE) to <code>Male</code></li>
</ol>
<div class="cell">
<details open="" class="code-fold">
<summary>hide code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a>gen_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">gender =</span> <span class="fu">c</span>(</span>
<span id="cb43-2"><a href="#cb43-2"></a>  <span class="st">"M"</span>, <span class="st">"male"</span>, <span class="st">"FEMALE"</span>, <span class="st">"f"</span>, <span class="st">"Fem"</span>, <span class="st">"maLe"</span>, </span>
<span id="cb43-3"><a href="#cb43-3"></a>  <span class="st">"Feemale"</span>, <span class="st">"fem."</span>, <span class="st">"MALE"</span>, <span class="st">"m."</span>, <span class="st">"femail"</span>, </span>
<span id="cb43-4"><a href="#cb43-4"></a>  <span class="st">"Unknown"</span>, <span class="st">"?"</span>, <span class="st">"u"</span>, <span class="st">"U."</span>, <span class="st">"N/A"</span>, <span class="st">"none"</span>, <span class="st">""</span>, </span>
<span id="cb43-5"><a href="#cb43-5"></a>  <span class="st">"Other"</span>,<span class="st">"prefer_not"</span>, </span>
<span id="cb43-6"><a href="#cb43-6"></a>  <span class="st">"MALE"</span>, <span class="st">"femAle"</span>, <span class="st">"Prefers not"</span>, <span class="st">"Othr"</span>, <span class="st">"na"</span></span>
<span id="cb43-7"><a href="#cb43-7"></a>))</span>
<span id="cb43-8"><a href="#cb43-8"></a></span>
<span id="cb43-9"><a href="#cb43-9"></a>gen_df <span class="ot">&lt;-</span> gen_df <span class="sc">%&gt;%</span> </span>
<span id="cb43-10"><a href="#cb43-10"></a>  <span class="fu">mutate</span>(<span class="at">gender_clean =</span> <span class="fu">case_when</span>(</span>
<span id="cb43-11"><a href="#cb43-11"></a>    <span class="fu">str_detect</span>(<span class="fu">str_to_lower</span>(gender), <span class="st">"^(m[^A-Za-z0-9]*$)|^(male)$"</span>) <span class="sc">~</span> <span class="st">"Male"</span></span>
<span id="cb43-12"><a href="#cb43-12"></a>  ))</span>
<span id="cb43-13"><a href="#cb43-13"></a></span>
<span id="cb43-14"><a href="#cb43-14"></a><span class="fu">print</span>(gen_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        gender gender_clean
1            M         Male
2         male         Male
3       FEMALE         &lt;NA&gt;
4            f         &lt;NA&gt;
5          Fem         &lt;NA&gt;
6         maLe         Male
7      Feemale         &lt;NA&gt;
8         fem.         &lt;NA&gt;
9         MALE         Male
10          m.         Male
11      femail         &lt;NA&gt;
12     Unknown         &lt;NA&gt;
13           ?         &lt;NA&gt;
14           u         &lt;NA&gt;
15          U.         &lt;NA&gt;
16         N/A         &lt;NA&gt;
17        none         &lt;NA&gt;
18                     &lt;NA&gt;
19       Other         &lt;NA&gt;
20  prefer_not         &lt;NA&gt;
21        MALE         Male
22      femAle         &lt;NA&gt;
23 Prefers not         &lt;NA&gt;
24        Othr         &lt;NA&gt;
25          na         &lt;NA&gt;</code></pre>
</div>
</div>
<p>Let’s break this regex down a bit more:</p>
<ul>
<li><p><code>^(m[^A-Za-z0-9]*$)</code> means detect the letter m or the letter m with other symbols that are NOT letters or digits.</p>
<ul>
<li><p>Earlier, it was mentioned that <code>^(m)$</code> means starts with m and ends with m, so simply JUST the letter m.</p></li>
<li><p>However, we also included <code>[^A-Za-z0-9]</code> which means other symbols that are NOT letters or digits.</p>
<ul>
<li><p>the NOT is given by the <code>^</code> INSIDE of the brackets <code>[]</code> -&gt; inside the brackets mean NEGATION.</p>
<ul>
<li><code>A-Za-z0-9</code> means any UPPERCASE letter, LOWERCASE letter, or digit so adding the <code>^</code> before that states we do NOT want these values.</li>
</ul></li>
<li><p><code>[^A-Za-z0-9]*</code> - the <code>*</code> at the end states that symbols other than letters or digits, such as <code>?</code>, <code>!</code>, <code>.</code>, can appear 0 or more times.</p></li>
</ul></li>
<li><p>Lastly, we end everything with <code>$</code> because we do not want to accept anything else after what we state above.</p></li>
</ul>
<p>For example:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>hide code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># does m work? YES</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str_detect</span>(<span class="st">"m"</span>, <span class="st">"^(m[^A-Za-z0-9]*$)|^(male)$"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<details open="" class="code-fold">
<summary>hide code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># does mA work? NO</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str_detect</span>(<span class="st">"mA"</span>, <span class="st">"^(m[^A-Za-z0-9]*$)|^(male)$"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
<details open="" class="code-fold">
<summary>hide code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># does m! work? YES</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str_detect</span>(<span class="st">"m!"</span>, <span class="st">"^(m[^A-Za-z0-9]*$)|^(male)$"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<details open="" class="code-fold">
<summary>hide code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># does m!a work? NO</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str_detect</span>(<span class="st">"m!a"</span>, <span class="st">"^(m[^A-Za-z0-9]*$)|^(male)$"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div></li>
</ul>
<ol start="4" type="1">
<li><p>Our case above should have captured all <code>Males</code> so let’s work on recoding <code>Female</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>hide code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>gen_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">gender =</span> <span class="fu">c</span>(</span>
<span id="cb53-2"><a href="#cb53-2"></a>  <span class="st">"M"</span>, <span class="st">"male"</span>, <span class="st">"FEMALE"</span>, <span class="st">"f"</span>, <span class="st">"Fem"</span>, <span class="st">"maLe"</span>, </span>
<span id="cb53-3"><a href="#cb53-3"></a>  <span class="st">"Feemale"</span>, <span class="st">"fem."</span>, <span class="st">"MALE"</span>, <span class="st">"m."</span>, <span class="st">"femail"</span>, </span>
<span id="cb53-4"><a href="#cb53-4"></a>  <span class="st">"Unknown"</span>, <span class="st">"?"</span>, <span class="st">"u"</span>, <span class="st">"U."</span>, <span class="st">"N/A"</span>, <span class="st">"none"</span>, <span class="st">""</span>, </span>
<span id="cb53-5"><a href="#cb53-5"></a>  <span class="st">"Other"</span>,<span class="st">"prefer_not"</span>, </span>
<span id="cb53-6"><a href="#cb53-6"></a>  <span class="st">"MALE"</span>, <span class="st">"femAle"</span>, <span class="st">"Prefers not"</span>, <span class="st">"Othr"</span>, <span class="st">"na"</span></span>
<span id="cb53-7"><a href="#cb53-7"></a>))</span>
<span id="cb53-8"><a href="#cb53-8"></a></span>
<span id="cb53-9"><a href="#cb53-9"></a>gen_df <span class="ot">&lt;-</span> gen_df <span class="sc">%&gt;%</span> </span>
<span id="cb53-10"><a href="#cb53-10"></a>  <span class="fu">mutate</span>(<span class="at">gender_clean =</span> <span class="fu">case_when</span>(</span>
<span id="cb53-11"><a href="#cb53-11"></a>    <span class="fu">str_detect</span>(<span class="fu">str_to_lower</span>(gender), <span class="st">"^(m[^A-Za-z0-9]*$)|^(male)$"</span>) <span class="sc">~</span> <span class="st">"Male"</span>,</span>
<span id="cb53-12"><a href="#cb53-12"></a>    <span class="fu">str_detect</span>(<span class="fu">str_to_lower</span>(gender), <span class="st">"^(f|female)$|(^fem)|(^fe+m)"</span>) <span class="sc">~</span> <span class="st">"Female"</span></span>
<span id="cb53-13"><a href="#cb53-13"></a>  ))</span>
<span id="cb53-14"><a href="#cb53-14"></a></span>
<span id="cb53-15"><a href="#cb53-15"></a><span class="fu">print</span>(gen_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        gender gender_clean
1            M         Male
2         male         Male
3       FEMALE       Female
4            f       Female
5          Fem       Female
6         maLe         Male
7      Feemale       Female
8         fem.       Female
9         MALE         Male
10          m.         Male
11      femail       Female
12     Unknown         &lt;NA&gt;
13           ?         &lt;NA&gt;
14           u         &lt;NA&gt;
15          U.         &lt;NA&gt;
16         N/A         &lt;NA&gt;
17        none         &lt;NA&gt;
18                     &lt;NA&gt;
19       Other         &lt;NA&gt;
20  prefer_not         &lt;NA&gt;
21        MALE         Male
22      femAle       Female
23 Prefers not         &lt;NA&gt;
24        Othr         &lt;NA&gt;
25          na         &lt;NA&gt;</code></pre>
</div>
</div></li>
</ol>
<p>Let’s break this regex down a bit more:</p>
<ul>
<li><p><code>^(f|female)$|(^fem)|(^fe+m)</code> means that we accept only <code>f</code> or only <code>female</code>, anything that starts with <code>fem</code> or anything that has <code>fe(with many letters of e)m</code> .</p>
<ul>
<li><p><code>(^fem)</code> anything that starts with <code>fem</code> (but can end with different things)</p>
<div class="cell">
<details open="" class="code-fold">
<summary>hide code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>{r}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'r' not found</code></pre>
</div>
<details open="" class="code-fold">
<summary>hide code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># does femail work? YES</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str_detect</span>(<span class="st">"femail"</span>, <span class="st">"^fem"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<details open="" class="code-fold">
<summary>hide code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># does femur work? YES</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str_detect</span>(<span class="st">"femur"</span>, <span class="st">"^fem"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div></li>
<li><p><code>(^fe+m)</code> means starts with fe and can include one instance of e or many instances of e (<code>e+</code>) but must end with m after</p>
<div class="cell">
<details open="" class="code-fold">
<summary>hide code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># does feeem work? YES</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str_detect</span>(<span class="st">"feem"</span>, <span class="st">"(^fe+m)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<details open="" class="code-fold">
<summary>hide code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># does feeemmm work? YES</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str_detect</span>(<span class="st">"femmm"</span>, <span class="st">"(^fe+m)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div></li>
</ul></li>
</ul>
<ol start="5" type="1">
<li><p>Next, since the above pattern captured everything that should be Female, let’s recategorize everything else into “Other”.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>hide code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a>gen_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">gender =</span> <span class="fu">c</span>(</span>
<span id="cb65-2"><a href="#cb65-2"></a>  <span class="st">"M"</span>, <span class="st">"male"</span>, <span class="st">"FEMALE"</span>, <span class="st">"f"</span>, <span class="st">"Fem"</span>, <span class="st">"maLe"</span>, </span>
<span id="cb65-3"><a href="#cb65-3"></a>  <span class="st">"Feemale"</span>, <span class="st">"fem."</span>, <span class="st">"MALE"</span>, <span class="st">"m."</span>, <span class="st">"femail"</span>, </span>
<span id="cb65-4"><a href="#cb65-4"></a>  <span class="st">"Unknown"</span>, <span class="st">"?"</span>, <span class="st">"u"</span>, <span class="st">"U."</span>, <span class="st">"N/A"</span>, <span class="st">"none"</span>, <span class="st">""</span>, </span>
<span id="cb65-5"><a href="#cb65-5"></a>  <span class="st">"Other"</span>,<span class="st">"prefer_not"</span>, </span>
<span id="cb65-6"><a href="#cb65-6"></a>  <span class="st">"MALE"</span>, <span class="st">"femAle"</span>, <span class="st">"Prefers not"</span>, <span class="st">"Othr"</span>, <span class="st">"na"</span></span>
<span id="cb65-7"><a href="#cb65-7"></a>))</span>
<span id="cb65-8"><a href="#cb65-8"></a></span>
<span id="cb65-9"><a href="#cb65-9"></a>gen_df <span class="ot">&lt;-</span> gen_df <span class="sc">%&gt;%</span> </span>
<span id="cb65-10"><a href="#cb65-10"></a>  <span class="fu">mutate</span>(<span class="at">gender_clean =</span> <span class="fu">case_when</span>(</span>
<span id="cb65-11"><a href="#cb65-11"></a>    <span class="fu">str_detect</span>(<span class="fu">str_to_lower</span>(gender), <span class="st">"^(m[^A-Za-z0-9]*$)|^(male)$"</span>) <span class="sc">~</span> <span class="st">"Male"</span>,</span>
<span id="cb65-12"><a href="#cb65-12"></a>    <span class="fu">str_detect</span>(<span class="fu">str_to_lower</span>(gender), <span class="st">"^(f|female)$|(^fem)|(^fe+m)"</span>) <span class="sc">~</span> <span class="st">"Female"</span></span>
<span id="cb65-13"><a href="#cb65-13"></a>  ), </span>
<span id="cb65-14"><a href="#cb65-14"></a>    <span class="at">gender_clean =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(gender_clean), <span class="st">"Unknown"</span>, gender_clean)</span>
<span id="cb65-15"><a href="#cb65-15"></a>  )</span>
<span id="cb65-16"><a href="#cb65-16"></a></span>
<span id="cb65-17"><a href="#cb65-17"></a><span class="fu">print</span>(gen_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        gender gender_clean
1            M         Male
2         male         Male
3       FEMALE       Female
4            f       Female
5          Fem       Female
6         maLe         Male
7      Feemale       Female
8         fem.       Female
9         MALE         Male
10          m.         Male
11      femail       Female
12     Unknown      Unknown
13           ?      Unknown
14           u      Unknown
15          U.      Unknown
16         N/A      Unknown
17        none      Unknown
18                  Unknown
19       Other      Unknown
20  prefer_not      Unknown
21        MALE         Male
22      femAle       Female
23 Prefers not      Unknown
24        Othr      Unknown
25          na      Unknown</code></pre>
</div>
</div></li>
</ol>
<p>In the above code, I am not using another pattern to detect for values that do not belong in either the Male or Female category, instead after I create the cases, I check for what is <code>NA</code>. If the variable <code>gender_clean</code> is NA, I fill that with <code>Unknown</code>. If it is not <code>NA</code>, I retain the value already there.</p>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>There are <strong>many</strong> ways you can detect your string, there is no <strong>one pattern</strong> or <strong>one answer only!</strong></p>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./07_EDA.html" class="pagination-link" aria-label="Exploratory Data Analysis">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Exploratory Data Analysis</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->




</body></html>